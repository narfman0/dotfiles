#!/bin/bash
export CLICOLOR=1
export EDITOR=vim
export LSCOLORS=ExFxBxDxCxegedabagacad
export NSS_SSL_CBC_RANDOM_IV=0
export GOPATH=$HOME/go
export PATH=$HOME/.local/bin:$HOME/bin:node_modules/.bin:$GOPATH/bin:$PATH
export PS1="[\u@\h \w]$ "

alias ll='ls -FGlAhp'
alias rf='find . 2> /dev/null | grep'
alias striphtml="sed 's|<[^>]*>||g'"
alias pt='python -m unittest discover'
alias ampc='cp $1 `grep UUID -A1 -a $1 | grep -io "[-A-Z0-9]\{36\}"`'
alias beep='echo -e "\a"'

alias gr='git fetch; git rebase -i origin/master'
alias grod='git fetch; git rebase -i origin/develop'
alias gru='git fetch upstream; git rebase -i upstream/master'

alias ta='tmux attach-session'
alias tia='tmux attach-session -t irssi'
alias tn='tmux new-session -s newsbeuter newsbeuter'
alias tna='tmux attach-session -t newsbeuter'

alias filebot='filebot.sh -rename --db TheTVDB -non-strict --format "{n} - {s00e00} - {t}"'
alias filebotAnime='filebot.sh -rename --db anidb -non-strict --format "{n} - {s00e00} - {t}"'
alias filebotTest='filebot.sh -rename --db TheTVDB -non-strict --format "{n} - {s00e00} - {t}" --action test'

alias genpass="openssl rand -base64 20"
alias c='clear'
alias ipe='curl ipinfo.io/ip'

if [ -x "$(command -v trash)" ]; then
    alias rm='trash'
fi

alias tfcvfs='if [ -f "secrets.tfvars" ]; then echo "--var-file=secrets.tfvars"; fi'
alias tfci='if [ ! -d ".terraform" ]; then terraform init; fi'
alias tfa='tfci; terraform apply $(tfcvfs)'
alias tfaa='tfci; terraform apply -auto-approve $(tfcvfs)'
alias tfd='tfci; terraform destroy $(tfcvfs)'
alias tffu='tfci; terraform force-unlock $(tfcvfs)'
alias tfinit='terraform init $(tfcvfs)'
alias tfi='tfci; terraform import $(tfcvfs)'
alias tfp='tfci; terraform plan $(tfcvfs)'
alias tfs='tfci; terraform state $(tfcvfs)'

#alias agr='ag "$1" --nogroup | awk '{print substr($1,1,index($1,":")-1);}' | xargs -I {} sed -i '.back' -e "s/$1/$2/g" {}'
ti() {
    tmux new-session -s irssi irssi
}
td() {
    tmux new-session -d bash
    tmux split-window -v
    tmux send-keys 'cd .' Enter
    tmux resize-p -y 10
    tmux -2 attach-session -d
}
newsbeuterpurge() {
    sqlite3 -line ~/.newsbeuter/cache.db "DELETE FROM rss_item WHERE unread = 1 AND pubDate < ( SELECT strftime('%s','now') - (10*86400));"
}
function cd(){
    builtin cd "${*}"
    if [ -e ".env" ]; then
        . .env
    fi
}
if [ -f ~/.git-completion.bash ]; then
  . ~/.git-completion.bash
fi
if [ -f ~/.tmux-completion.bash ]; then
  . ~/.tmux-completion.bash
fi
if [ -f ~/.vault-completion.bash ]; then
  . ~/.vault-completion.bash
fi
complete -W "\`grep -oE '^[a-zA-Z0-9_.-]+:([^=]|$)' Makefile | sed 's/[^a-zA-Z0-9_.-]*$//'\`" make
